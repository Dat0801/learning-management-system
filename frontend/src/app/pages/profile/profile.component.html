<div class="profile-container page-container">
  <div class="settings-layout">
    <!-- Settings Sidebar -->
    <div class="settings-sidebar">
      <div class="sidebar-header">
        <h2>Settings</h2>
      </div>
      
      <nav class="settings-nav">
        <a 
          class="nav-item" 
          [class.active]="activeTab === 'personal-info'"
          (click)="switchTab('personal-info')"
        >
          <div class="nav-icon"><i class="fas fa-user"></i></div>
          <span>Personal Info</span>
        </a>
        <a 
          class="nav-item" 
          [class.active]="activeTab === 'security'"
          (click)="switchTab('security')"
        >
          <div class="nav-icon"><i class="fas fa-shield-alt"></i></div>
          <span>Security</span>
        </a>
        <a 
          class="nav-item" 
          [class.active]="activeTab === 'notifications'"
          (click)="switchTab('notifications')"
        >
          <div class="nav-icon"><i class="fas fa-bell"></i></div>
          <span>Notifications</span>
        </a>
        <a 
          class="nav-item" 
          [class.active]="activeTab === 'billing'"
          (click)="switchTab('billing')"
        >
          <div class="nav-icon"><i class="fas fa-wallet"></i></div>
          <span>Billing</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="user-mini-profile">
          <div class="mini-avatar">
            <img *ngIf="user?.avatar" [src]="user.avatar" alt="User">
            <span *ngIf="!user?.avatar">{{ user?.name?.charAt(0) || 'U' }}</span>
          </div>
          <div class="user-details">
            <span class="user-name">{{ user?.name || 'User' }}</span>
            <span class="user-role">{{ user?.role === 'admin' ? 'Admin' : 'Premium Member' }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="settings-content">
      <!-- Header -->
      <header class="content-header">
        <h1>Account Settings</h1>
        <div class="header-actions">
          <button class="icon-btn"><i class="fas fa-search"></i></button>
          <button class="icon-btn"><i class="fas fa-question-circle"></i></button>
        </div>
      </header>

      <!-- Alert Message -->
      <div *ngIf="message.content" class="alert" [ngClass]="'alert-' + message.type">
        {{ message.content }}
      </div>

      <!-- Personal Info Tab -->
      <div *ngIf="activeTab === 'personal-info'" class="tab-content fade-in">
        
        <!-- Personal Profile Section -->
        <section class="content-card profile-section">
          <div class="profile-header">
            <div class="profile-avatar-large">
              <img *ngIf="user?.avatar" [src]="user.avatar" alt="Profile">
              <span *ngIf="!user?.avatar">{{ user?.name?.charAt(0) || 'U' }}</span>
              <button class="btn-edit-avatar"><i class="fas fa-camera"></i></button>
            </div>
            <div class="profile-summary">
              <h3>Personal Profile</h3>
              <p class="subtitle">Update your personal details and public profile presence.</p>
              
              <div class="bio-field">
                <label>BIO</label>
                <form [formGroup]="profileForm">
                  <textarea 
                    formControlName="bio" 
                    placeholder="Tell us about yourself..."
                    rows="3"
                  ></textarea>
                </form>
              </div>
            </div>
          </div>
        </section>

        <!-- General Information Section -->
        <section class="content-card">
          <h3>General Information</h3>
          <form [formGroup]="profileForm" class="general-info-form">
            <div class="form-grid">
              <div class="form-group">
                <label>First Name</label>
                <input type="text" formControlName="firstName" class="form-control">
              </div>
              <div class="form-group">
                <label>Last Name</label>
                <input type="text" formControlName="lastName" class="form-control">
              </div>
              <div class="form-group">
                <label>Email Address</label>
                <input type="email" formControlName="email" class="form-control">
              </div>
              <div class="form-group">
                <label>Phone Number</label>
                <input type="tel" formControlName="phone" class="form-control">
              </div>
              <div class="form-group">
                <label>LinkedIn URL</label>
                <input type="text" formControlName="linkedin" class="form-control">
              </div>
              <div class="form-group">
                <label>Personal Portfolio</label>
                <input type="text" formControlName="portfolio" class="form-control">
              </div>
            </div>
          </form>
        </section>

        <!-- Skills Earned Section -->
        <section class="content-card">
          <div class="card-header">
            <h3>Skills Earned</h3>
            <a href="javascript:void(0)" class="link-action">View All Certificates</a>
          </div>
          <div class="skills-grid">
            <div class="skill-card" *ngFor="let skill of skills" [style.background-color]="skill.color">
              <div class="skill-icon" [style.color]="skill.iconColor">
                <i [class]="skill.icon"></i>
              </div>
              <span class="skill-name">{{ skill.name }}</span>
            </div>
            <div class="skill-card placeholder-card">
              <div class="lock-icon"><i class="fas fa-lock"></i></div>
              <span class="skill-name">Next Milestone</span>
            </div>
          </div>
        </section>

        <!-- Learning Activity Section -->
        <section class="content-card">
          <div class="card-header">
            <div>
              <h3>Learning Activity</h3>
              <p class="subtitle">Your engagement over the past 12 months</p>
            </div>
            <div class="streak-badge">
              <span class="count">284</span>
              <span class="label">Day Streak</span>
            </div>
          </div>
          
          <div class="activity-heatmap">
            <div 
              class="day-cell" 
              *ngFor="let active of activityData"
              [class.active]="active"
            ></div>
          </div>
          <div class="heatmap-legend">
            <span>Less</span>
            <div class="legend-scale">
              <span class="l-1"></span>
              <span class="l-2"></span>
              <span class="l-3"></span>
              <span class="l-4"></span>
            </div>
            <span>More</span>
          </div>
        </section>

        <!-- Footer Actions -->
        <div class="form-actions-footer">
          <button class="btn-cancel">Cancel Changes</button>
          <button class="btn-save" (click)="onSubmitProfile()" [disabled]="isUpdatingProfile">
            {{ isUpdatingProfile ? 'Saving...' : 'Save Preferences' }}
          </button>
        </div>
      </div>

      <!-- Security Tab (Reuse existing password form) -->
      <div *ngIf="activeTab === 'security'" class="tab-content fade-in">
        <section class="content-card">
          <h3>Change Password</h3>
          <form [formGroup]="passwordForm" (ngSubmit)="onSubmitPassword()" class="password-form">
            <div class="form-group">
              <label>Current Password</label>
              <input type="password" formControlName="current_password" class="form-control">
            </div>
            <div class="form-group">
              <label>New Password</label>
              <input type="password" formControlName="new_password" class="form-control">
            </div>
            <div class="form-group">
              <label>Confirm New Password</label>
              <input type="password" formControlName="new_password_confirmation" class="form-control">
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-save" [disabled]="passwordForm.invalid || isChangingPassword">
                {{ isChangingPassword ? 'Updating...' : 'Update Password' }}
              </button>
            </div>
          </form>
        </section>
      </div>

      <!-- Placeholders for other tabs -->
      <div *ngIf="activeTab === 'notifications'" class="tab-content fade-in">
        <section class="content-card">
          <h3>Notifications</h3>
          <p>Notification settings coming soon.</p>
        </section>
      </div>

      <div *ngIf="activeTab === 'billing'" class="tab-content fade-in">
        <section class="content-card">
          <h3>Billing Information</h3>
          <p>Billing settings coming soon.</p>
        </section>
      </div>

    </div>
  </div>
</div>
