<div class="user-management">
  <h1>User Management</h1>

  <!-- Search and Filter -->
  <div class="search-bar">
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (keyup)="onSearch()"
      placeholder="Search by name or email..."
      class="search-input"
    />
    <select [(ngModel)]="selectedRole" (change)="onSearch()" class="role-filter">
      <option value="">All Roles</option>
      <option value="student">Student</option>
      <option value="instructor">Instructor</option>
      <option value="admin">Admin</option>
    </select>
  </div>

  <!-- Users Table -->
  <div class="table-container" *ngIf="users$ | async as response">
    <table class="users-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Role</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of response.data">
          <td>{{ user.id }}</td>
          <td>{{ user.name }}</td>
          <td>{{ user.email }}</td>
          <td>
            <span class="role-badge" [ngClass]="'role-' + user.role">
              {{ user.role }}
            </span>
          </td>
          <td class="actions">
            <button class="btn-enroll" (click)="openEnrollModal(user)">Enroll</button>
            <button class="btn-edit" (click)="editUser(user)">Edit</button>
            <button class="btn-delete" (click)="deleteUser(user.id)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Edit Form -->
  <div class="modal" *ngIf="showEditForm">
    <div class="modal-content">
      <h2>Edit User</h2>
      <form *ngIf="editingUser">
        <div class="form-group">
          <label>Name</label>
          <input type="text" [(ngModel)]="editingUser.name" name="name" />
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" [(ngModel)]="editingUser.email" name="email" />
        </div>
        <div class="form-group">
          <label>Role</label>
          <select [(ngModel)]="editingUser.role" name="role">
            <option *ngFor="let role of roles" [value]="role">{{ role }}</option>
          </select>
        </div>
        <div class="form-group">
          <label>Password</label>
          <input 
            type="password" 
            [(ngModel)]="editingUser.password" 
            name="password" 
            [placeholder]="editingUser.id ? 'Leave blank to keep current' : 'Enter password'"
            [required]="!editingUser.id"
          />
        </div>
        <div class="form-actions">
          <button type="button" class="btn-save" (click)="saveUser()">Save</button>
          <button type="button" class="btn-cancel" (click)="cancelEdit()">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
